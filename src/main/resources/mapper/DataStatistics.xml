<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jianpanmao.dataStatistics.dao.DataStatisticsMapper">

  <select id="IntermediaryDeviceCount" resultType="java.util.HashMap">
SELECT COUNT(d.device_id) count,
 i.intermediary_name
 from device d
 RIGHT JOIN intermediary i
 on d.intermediary_id = i.intermediary_id
GROUP BY i.intermediary_name
ORDER BY count DESC
  </select>
</mapper>