<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">
<head>
    <link rel="stylesheet" th:href="@{/dist/css/gzh-l/webuploader.css}"/>
    <link rel="stylesheet" th:href="@{/dist/css/gzh-l/gzh-common.css}"/>
    <style>
        .gzh-manage-menu{
            margin-top: 15px;
            margin-left: 5px;
        }
        .gzh-manage-menu a{
            color: #000000;
            padding: 0 15px;
            cursor: pointer;
        }
        .tex-color{
            color: #6FB3E0!important;
        }
        #backUl{
            margin-right: 35px;
            margin-top: -10px;
        }
        .gzh-source-type{
            margin-top: 2%;
            height: 40px;
            line-height: 40px;
            width: 100%;
            margin-left: 20px;
            background: #F5F5F5;
            box-shadow: #9c9c9c 3px 3px 3px 3px;
        }
        .gzh-source-type a{
            font-size: 16px;
            color: #626262;
            padding: 0 15px;
            cursor: pointer;
            width: 100px;
            display: inline-block;
           text-align: center;
        }
        .gzh-source-type a:hover{
            text-decoration: none;
        }
        .tex-bgcolor {
            height: 40px!important;
            color: #1d1d1d !important;
            display: inline-block;
            background: #b8b8b8;
            font-weight: 500;
        }
        #imgShow li{
            width: 150px;
            height: 150px;
            display: inline-block;
            border: 1px #727272 solid;
            list-style: none;
            margin: 5px;
            position: relative;
        }
        #imgShow li img{
            width: 150px;
            height: 150px;
            display: inline-block;
            border: 1px #727272 solid;
            cursor: pointer;
        }
        #pagingTest a{
            border: 1px solid #b0b0b0;
            padding: 5px 10px;
            margin: 0 5px;
            cursor: pointer;
        }
        #pagingTest{
            margin-left: 20px;
            margin-top: 30px;
        }
        #pagingTest a:hover{
         text-decoration: none;
        }
        #pagingTest a.current{
            color: white;
            background: deepskyblue;
        }
        #pagingTest a.disable{
            background: gray;
            color: white;
            cursor: default;
        }
        #mpShow li{
            width: 180px;
            height: 180px;
            display: inline-block;
            border: 1px #727272 solid;
            margin-left: 15px;
            margin-top: 15px;
        }
        #mpShow li audio{
            width: 180px;
            height: 180px;
            display: inline-block;
            border: 1px #727272 solid;
            cursor: pointer;
        }
        #vidShow li{
            width: 180px;
            height: 180px;
            display: inline-block;
            border: 1px #727272 solid;
            margin-left: 15px;
            margin-top: 15px;
        }
        #vidShow li video{
            width: 180px;
            height: 180px;
            display: inline-block;
            border: 1px #727272 solid;
            cursor: pointer;
        }
        .newPhotoText a{
            display: inline-block;
            cursor: pointer;
            width: 100%;
            height: 50px;
            line-height:50px;
            text-align: center;
            border: 1px #bcbcbc solid;
            font-size: 16px;
        }
        .addInp{
            width: 90%;
            margin-left: 5%;
            height: 40px;
            line-height: 40px;
            margin-top: 30px;
            border: none!important;
        }
        #editInputAutor{
            border-bottom: 1px #e5e5e5 solid!important;
        }
    </style>
</head>
<body layout:fragment="content">

<div class="row">
    <div id="gzh-manage">
        <section class="content-header gzh-manage-menu">
            <a class="font-size-14" data-id="1">用户管理</a>
            <a class="font-size-14" data-id="2">菜单管理</a>
            <a class="font-size-14" data-id="3">消息管理</a>
            <a class="font-size-14 tex-color" data-id="4">素材管理</a>
            <button class="btn btn-info search text-center pull-right" id="backUl">返回</button>
        </section>
        <div style="margin-top:2%;width: 98%;height: auto;font-size: 13px;">
            <div class="content-header gzh-source-type">
                <a class="" data-id="1">图文消息</a>
                <a class="" data-id="2">图片</a>
                <a class="" data-id="3">语音</a>
                <a class="" data-id="4">视频</a>
            </div>
            <div style="margin-top: 2%;">
                <span style="margin-left: 2%"><a class="new-type-name">图文消息</a><a>（共1条）</a></span>
                <div style="width: 120px;height: 30px;float: right;">
                    <div id="filePicker" style="width: 120px;height: 42px;background: #666e95;text-align: center;line-height: 42px;color: #FFFFFF;border-radius: 5px;">新建图文信息</div>
                    <div id="filePicker1" style="display: none">上传图片</div>
                    <div id="filePicker2" style="display: none">添加语音</div>
                    <div id="filePicker3" style="display: none;">添加视频</div>
                </div>
            </div>
            <!--素材库图文消息内容-->
            <div>
                <div style="height: 500px;border: 1px #e0e0e0 solid;margin-top: 2%;width: 98%;margin-left: 2%;" id="photo-tx">
                </div>
                <!--图片-->
                <div id="photo-show" style="height: 500px;border: 1px #e0e0e0 solid;margin-top: 2%;width: 95%;margin-left: 2%;display: none;overflow: auto;">
                    <ul id="imgShow"></ul>
                    <div id="pagingTest" class="pageIndex"></div>
                    <input type="hidden" value="" id="page">
                </div>
                <!--语音-->
                <div id="source" style="height: 500px;border: 1px #e0e0e0 solid;margin-top: 2%;width: 95%;margin-left: 2%;display: none;">
                    <ul id="mpShow"></ul>
                    <div id="pagingTest1" class="pageIndex"></div>
                    <input type="hidden" value="" id="page1">
                </div>
                <!--视频-->
                <div id="vid" style="height: 500px;border: 1px #e0e0e0 solid;margin-top: 2%;width: 95%;margin-left: 2%;display: none;">
                    <ul id="vidShow"></ul>
                    <div id="pagingTest2" class="pageIndex"></div>
                    <input type="hidden" value="" id="page2">
                </div>
            </div>
        </div>
    </div>
    <!--新建图文素材-->
    <div id="new-photo-text" style="display: none;">
        <div class="source-title" style="margin-top: 15px;margin-left: 20px;">新建图文消息</div>
        <button class="btn btn-info search text-center pull-right" id="backStore" style="margin-right: 35px;margin-top: -35px;">返回</button>
        <div style="margin-left: 10%;margin-top:2%;width: 80%;height: 600px;">
            <section class="float-left" style="width: 65%;height: 99%;">
                <div>
                      <textarea name="editor1" id="editor1">

                      </textarea>
                </div>
                <button style="width: 65px;height: 35px;display: block;" id="savapt">保存</button>
            </section>
            <section class="float-left" style="width: 15%;margin-left: 1.5%">
                <label style="width:100%;margin-top: 15px;margin-left: 35px;" class="text-center;">多媒体</label>
                <div style="width: 60%;margin-left: 20%;margin-top: 20px;" class="newPhotoText">
                    <a style="border-bottom: none;" data-id="1">图片</a>
                    <a style="border-bottom: none;" data-id="2">视频</a>
                    <a style="" data-id="3">音频</a>
                </div>
            </section>
        </div>
    </div>
    <!--素材库弹窗-->
    <div class="modal" id="sourceRoom" tabindex="-1" role="dialog" aria-labelledby="mySource" style="position: absolute;top:12%;">
        <div class="modal-dialog" role="document" style="width: 50%;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title text-left" id="mySource"></h4>
                </div>
                <div class="modal-body" style="min-height: 400px;">
                    <ul id="popImg"></ul>
                    <div id="popPagingTest" class="pageIndex"></div>
                    <input type="hidden" value="" id="popPage">
                </div>
                <div class="modal-footer">
                    <button type="button" id="btn-sure-source" class="btn btn-primary text-center" data-dismiss="modal">确定</button>
                    <button type="button" id="btn-cancel-source" class="btn btn-primary text-center" data-dismiss="modal">取消</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script th:src="@{/dist/js/gzh/gzh-common.js}"></script>
<script th:src="@{/dist/js/gzh/webuploader.js}"></script>
<script th:src="@{/dist/js/gzh/upload.js}"></script>
<script th:src="@{/dist/js/gzh/hand-paging.js}"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    var wxPublicId = /*[[${wxPublicId}]]*/;
    /*]]>*/
    $(function () {
        //从外部获取该相应的菜单
        function getUrlParms(name){
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if(r!=null)
                return unescape(r[2]);
            return null;
        }
        var id = getUrlParms("id");
        if(id==null){
            $(".gzh-source-type>a:eq(0)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".new-type-name").text("图文消息");
            $("#filePicker").show().siblings().hide();
            $("#photo-tx").show().siblings().hide();
        }else if(id==1){
            $(".gzh-source-type>a:eq(0)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".gzh-source-type>a:eq(0)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".new-type-name").text("图文消息");
            $("#filePicker").show().siblings().hide();
            $("#photo-tx").show().siblings().hide();
        }else if(id==2){
            $(".gzh-source-type>a:eq(1)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".new-type-name").text("图片");
            $("#filePicker1").show().siblings().hide();
            $("#photo-show").show().siblings().hide();
            ajaxData(1);
        }else if(id==3){
            $(".gzh-source-type>a:eq(2)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".new-type-name").text("语音");
            $("#filePicker2").show().siblings().hide();
            $("#source").show().siblings().hide();
            ajaxMp(1);
        }else if(id==4){
            $(".gzh-source-type>a:eq(3)").addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
            $(".new-type-name").text("视频");
            $("#filePicker3").show().siblings().hide();
            $("#vid").show().siblings().hide();
            //ajaxVid(1);
        }
        //菜单选中
        $(document).on("click",".gzh-source-type>a",function () {
            $(this).addClass("tex-bgcolor").siblings().removeClass("tex-bgcolor");
        });
       //上传bug
        setTimeout(function(){
            $(".webuploader-pick").next().css({
                position: "absolute",
                top: "0px",
                left: "15px",
                width: "85px",
                height: "40px",
                overflow: "hidden",
                opacity: 0
            });
        }, 1000);
        //点击tab页面切换功能
        $(".gzh-source-type a").click(function () {
            var cliID=$(this).attr("data-id");
            $(this).addClass("cli-color").siblings().removeClass("cli-color");
            if(cliID=="1"){
                $(".new-type-name").text("图文消息");
                $("#filePicker").show().siblings().hide();
                $("#photo-tx").show().siblings().hide();
            } else if(cliID=="2"){
                $(".new-type-name").text("图片");
                $("#filePicker1").show().siblings().hide();
                $("#photo-show").show().siblings().hide();
                 ajaxData(1);
            } else if(cliID=="3"){
                $(".new-type-name").text("语音");
                $("#filePicker2").show().siblings().hide();
                $("#source").show().siblings().hide();
                ajaxMp(1);
            } else if(cliID=="4"){
                $(".new-type-name").text("视频");
                $("#filePicker3").show().siblings().hide();
                $("#vid").show().siblings().hide();
                ajaxVid(1);
            }
        })
        //新建素材页面
        $(document).on("click","#filePicker",function () {
           $("#new-photo-text").show().siblings().hide();
        });
        //文本编辑器
//         function textEdior(){
//             //var editor;
//             CKEDITOR.replace( 'editor1', {
//                 height:520,
//                 customConfig: '',
//                 filebrowserImageUploadUrl:"skins",
//                 removeDialogTabs:"image:advanced;image:Link",
//                 toolbarGroups: [
//                     {"name":"basicstyles","groups":["basicstyles"]},
//                     {"name":"links","groups":["links"]},
//                     {"name":"paragraph","groups":["list","blocks"]},
//                     // {"name":"document","groups":["mode"]},
//                     {"name":"insert","groups":["insert"]},
// //                {"name":"styles","groups":["styles"]},
//                     {"name":"about","groups":["about"]}
//                 ],
//                 removePlugins:"elementspath"
//             });
//         }
//         textEdior();
        CKEDITOR.replace( 'editor1',{
            height:450,
            toolbarGroups: [
                {"name":"basicstyles","groups":["basicstyles"]},
                {"name":"links","groups":["links"]},
                {"name":"paragraph","groups":["list","blocks"]},
//            {"name":"document","groups":["mode"]},
                {"name":"insert","groups":["insert"]},
                //{"name":"styles","groups":["styles"]},
//            {"name":"about","groups":["about"]}
            ]
        });
        CKEDITOR.on( 'instanceReady', function (ev) {

            var title = '<input type="text" id="editInputTitle" class="addInp" placeholder="请输入标题" style="font-size: 20px;">' +
                '<input type="text" id="editInputAutor" class="addInp" placeholder="请输入作者" >';
            $("#cke_1_contents").before(title);
            $(".addInp").on('focus',function(){
                ev.editor.setReadOnly( true );
            })
            $(".addInp").on('blur',function(){
                ev.editor.setReadOnly( false );
            })
            var editor1 = CKEDITOR.instances.editor1;
            editor1.focus();
        });



        //新建素材返回菜单
        $(document).on("click","#backStore",function () {
            $("#gzh-manage").show().siblings().hide();
        })
        //多媒体选中newPhotoText
        $(document).on("click",".newPhotoText a",function () {
            var thisId=$(this).attr("data-id");
            $('#sourceRoom').modal();
            if(thisId==1){
                $("#mySource").text("选择图片");
            }else if(thisId==2){
                $("#mySource").text("选择视频");
            }else if (thisId==3){
                $("#mySource").text("选择音频");
            }
            //$("#gzh-manage").show().siblings().hide();
        })

    })
</script>

</body>

</html>